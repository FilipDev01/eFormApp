<form [formGroup]="section" *ngIf="individual_codes" (ngSubmit)="onSubmit()">
  <mat-form-field [class.mat-input-invalid]="isInvalid" [class.mat-form-field-invalid]="isInvalid">
    <mat-label>Počet</mat-label>
    <input matInput type="number" min="0" placeholder="Počet" formControlName="no_individuals" required>
  </mat-form-field>

  <p class="mt-1 mb-0"><strong>Osvety</strong></p>
  <table class="table table-responsive enlightenment-table mb-0">
    <tbody>
      <ng-container *ngIf="individual_codes?.controls" formArrayName="individual_codes">
        <tr *ngFor="let item of individual_codes.controls; index as i">
          <ng-container [formGroupName]="i">
            <td class="table-colum-code pl-0" colspan="1">
              <mat-form-field class="p-0">
                <mat-label>Kód</mat-label>
                <mat-select #matSelectA class="eform-mat-select" name="a" formControlName="description">
                  <mat-select-trigger>
                    {{item.value.description}}
                  </mat-select-trigger>
                  <header class="mat-select">
                    <h4 class="text-center mb-0 py-3">Vyber Kód</h4>
                    <mat-divider class="table-divider"></mat-divider>
                  </header>
                  <div class="custom-panel">
                    <mat-option *ngFor="let enlightenmentOption of enlightenmentOptions"
                      [value]="enlightenmentOption.code">
                      <small>{{enlightenmentOption.code}}: {{enlightenmentOption.description}}</small>
                    </mat-option>
                  </div>
                  <footer class="mat-select mt-footer">
                    <button mat-raised-button (click)="handleSelectionAction('a');" type="button">Zruš</button>
                  </footer>
                </mat-select>
              </mat-form-field>
            </td>
            <td class="px-0">
              <mat-form-field class="p-0">
                <mat-label>Počet</mat-label>
                <input matInput type="number" min="0" name="a" formControlName="count">
              </mat-form-field>
            </td>
            <td class="table-column-action pr-0">
              <p class="text-danger" (click)="removeCode(section.controls.individual_codes, item)">X</p>
            </td>

          </ng-container>
        </tr>
      </ng-container>

      <tr>
        <td class="text-start" style="padding-right: 0 !important;" colspan="3">
          <button mat-flat-button class="bg-success mt-2 pb-0 px-2 btn-add-e"
            (click)="addCode(section, 'individual_codes')" type="button">
            Pridaj Osvetu
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <p *ngIf="isInvalid" class="e-wizard-err-msg">
    <small>Počet osôb sa nezhoduje s počtom interakcií!</small>
  </p>
  <mat-divider class="mt-3 mb-2"></mat-divider>

  <div class="text-end">
    <button mat-flat-button color="primary" type="submit">Ďalej</button>
  </div>
</form>
